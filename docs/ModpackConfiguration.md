# Modpack Configuration Guide

Brightbronze Horizons is designed to be highly configurable for modpacks. Configuration is split into two layers:

1.  **Runtime Configuration (`config/brightbronze_horizons.json`)**: Handles global settings, performance toggles, and feature flags. This file is generated in the `config` folder.
2.  **Data-Driven Rules**: Json files in data packs that define biome assignments, structural rules, and content generation.

## Runtime Configuration

The main configuration file is located at `config/brightbronze_horizons.json`.

### Structure

```json
{
  "enableStartingArea": true,
  "preferVillageStart": true,
  "enableChunkSpawnMobs": true,
  "chunkCopyLayersPerTick": 8,
  "maxSourceDimensions": 0,
  "tiersEnabled": {
    "COPPER": true,
    "COAL": true,
    "IRON": true,
    "GOLD": true,
    "EMERALD": true,
    "DIAMOND": true
  },
  "tierBlockOverrides": {},
  "version": 1
}
```

### Options

| Option | Type | Default | Description |
| :--- | :--- | :--- | :--- |
| `enableStartingArea` | Boolean | `true` | If true, generates the initial starting island structure. If false, the world generates empty (void) unless another mod populates it. |
| `preferVillageStart` | Boolean | `true` | If true, the mod attempts to center the starting area on a village structure for a better early-game experience. |
| `enableChunkSpawnMobs` | Boolean | `true` | Controls whether mobs are spawned via script when a chunk is generated by a player. |
| `chunkCopyLayersPerTick` | Integer | `8` | Performance setting. Controls how many vertical chunk sections are copied per tick during generation to prevent server lag. Higher values are faster but may cause stutter. |
| `maxSourceDimensions` | Integer | `0` | Managing disk usage. Limits the number of source dimensions kept on disk. `0` means unlimited. |
| `tiersEnabled` | Map | All true | Allows disabling specific chunk spawner tiers. Keys are tier names (e.g. "COPPER"). |
| `tierBlockOverrides` | Map | Empty | (Advanced) Allows overriding the crafting block required for a tier. |

## Data-Driven Biome Rules

The core gameplay logic for expanding the world is driven by **Biome Rules**. These rules determine which biomes can be spawned by which tier of Chunk Spawner.

Rules are strictly **data-driven** via JSON files in data packs. This allows modpacks to:
- Add support for modded biomes.
- Change the tier of vanilla biomes.
- Customize block replacements (e.g., replace ores).
- Customize mob spawning behavior on new chunks.

### File Location

Rule files must be placed in:
`data/<namespace>/biome_rules/<filename>.json`

You can use any namespace (e.g., `your_modpack_id`) and any filename.

Running the mod adds default rules under the `brightbronze_horizons` namespace (e.g. `data/brightbronze_horizons/biome_rules/000_default_copper.json`). You can inspect these in the mod jar.

### Rule Structure

A biome rule definition has the following fields:

| Field | Type | Description |
| :--- | :--- | :--- |
| `tier` | String | The tier that this rule applies to. Valid values: `COPPER`, `COAL`, `IRON`, `GOLD`, `EMERALD`, `DIAMOND`. Case-insensitive. |
| `biome_tag` | String | A biome tag (e.g., `#minecraft:is_overworld`) to match biomes. |
| `allow` | List\<String\> | (Optional) Explicit list of biome IDs to include, even if they don't match the tag. |
| `deny` | List\<String\> | (Optional) Explicit list of biome IDs to exclude, even if they match the tag. |
| `priority` | Integer | Resolution order. Higher priority rules override lower priority ones if a biome matches multiple rules. Default: 0. |
| `weight` | Integer | Selection weight. Higher values make biomes matching this rule more likely to be chosen for the tier. Default: 10. |
| `replacements` | List | (Optional) List of block replacement rules. |
| `mob_spawns` | List | (Optional) List of mob spawn rules. |

### Example Rule

```json
{
  "tier": "EMERALD",
  "priority": 100,
  "weight": 20,
  "biome_tag": "#c:is_magical",
  "allow": [
    "terralith:moonlight_valley",
    "terralith:mirage_isles"
  ],
  "deny": [
    "terralith:dangerous_peaks"
  ],
  "replacements": [
    {
      "match": "minecraft:diamond_ore",
      "replace_with": "minecraft:stone"
    }
  ],
  "mob_spawns": [
    {
      "entity": "minecraft:witch",
      "min": 1,
      "max": 2
    }
  ]
}
```

### Block Replacements

The `replacements` field is a list of objects defining how blocks in the source chunk are transformed when copied to the player's world.

Each replacement object matches using a `match` field (block ID or tag) and providing a `replace_with` ID.

**Match by Block ID:**
```json
{
  "match": "minecraft:copper_ore",
  "replace_with": "minecraft:iron_ore"
}
```

**Match by Block Tag:**
(Prefix with `#`)
```json
{
  "match": "#c:ores",
  "replace_with": "minecraft:stone"
}
```
*Note: `replace_with` must always be a single Block ID. Providing `minecraft:air` removes the block.*

### Mob Spawns

The `mob_spawns` field defines a list of entities that should be spawned once when the chunk is generated.

```json
{
  "entity": "minecraft:zombie",
  "min": 2,
  "max": 4
}
```

This spawns between 2 (`min`) and 4 (`max`) zombies.

## Starting Area Customization

The starting area has limited configuration options in the current version.

-   **Size:** Fixed at 3x3 chunks.
-   **Biome:** Defaults to Plains. If the world spawn is effectively a safe biome (like Plains), it uses that. Otherwise, it forcibly sets the biome to Plains.
-   **Structure:** It attempts to center on a Village if `preferVillageStart` is true in the runtime config.

Changes to the starting area biome or structure must currently be done by modifying the source code or using a different mod to control the spawn chunks before Brightbronze Initializes.

## Default Data

The mod includes built-in data packs defining default rules for vanilla biomes. You can inspect these in the mod jar under `data/brightbronze/brightbronze/rules/`. Modpacks can override these by providing a rule with a higher priority or by using a datapack that loads after the mod's default data.
